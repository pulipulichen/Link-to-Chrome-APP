<html>
    <head><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-37178375-7', 'auto');
  ga('send', 'pageview');

</script>
<script type="text/javascript">

var _url = findGetParameter("url");
var _icon = findGetParameter("icon");

function findGetParameter(parameterName) {
  /*
  if (parameterName === "url") {
    return "http://blog.pulipuli.info/"
  }
  else if (parameterName === "icon") {
    return "https://pulipulichen.github.io/Link-to-Chrome-APP/public/favicon.ico"
  }
  */
  
    var result = undefined,
        tmp = [];
    location.search
    .substr(1)
        .split("&")
        .forEach(function (item) {
        tmp = item.split("=");
        if (tmp[0] === parameterName) result = decodeURIComponent(tmp[1]);
    });
    return result;
}

if (history.previous !== undefined) {
    location.href = findGetParameter("url");
}
else {
    if (_icon !== undefined) {
        var head  = document.getElementsByTagName('head')[0];
        var link  = document.createElement('link');
        link.rel  = 'shortcut icon';
        link.href = findGetParameter("icon");
        head.appendChild(link);
        console.log('<link red="shortcut icon" href="'+link.href+'" />');
    }

    if (_url !== undefined) {
        //var win = window.open(findGetParameter("url"), "_blank", "resizable,scrollbars=yes,status=1");
        var win = window.open("http://blog.pulipuli.info", "_blank", "resizable,scrollbars=yes,status=1");
        
        // 這邊要確認看看網頁是否有開啟，然後才關閉這個視窗
        setTimeout(function () {
          if (win !== null && win.window !== null) {
            window.close();
          }
          else {
            document.getElementById("message").innerHTML = "Popup is blocked."
          }
        }, 1000)
        
    }
}



            </script>
            <title>Popup</title>
    </head>
    <body>
      <div id="message">Waiting open popup...</div>
    </body>
</html>