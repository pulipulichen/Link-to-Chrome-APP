<html>
    <head><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-37178375-7', 'auto');
  ga('send', 'pageview');

</script>
            <title>APP</title>
    </head>
    <body>
      <div id="message">Waiting open APP...</div>
      <div id="icon"></div>
      <div id="url"></div>

<script type="text/javascript">

var _url = findGetParameter("url");
var _icon = findGetParameter("icon");

function findGetParameter(parameterName) {
  if (parameterName === "url") {
    return "http://blog.pulipuli.info/"
  }
  else if (parameterName === "icon") {
    return "https://pulipulichen.github.io/Link-to-Chrome-APP/public/favicon.ico"
  }
  
    var result = undefined,
        tmp = [];
    location.search
    .substr(1)
        .split("&")
        .forEach(function (item) {
        tmp = item.split("=");
        if (tmp[0] === parameterName) result = decodeURIComponent(tmp[1]);
    });
    return result;
}

if (history.previous !== undefined) {
    location.href = findGetParameter("url");
}
else {
    if (_icon !== undefined) {
        var head  = document.getElementsByTagName('head')[0];
        var link  = document.createElement('link');
        link.rel  = 'shortcut icon';
        link.href = findGetParameter("icon");
        head.appendChild(link);
        console.log('<link red="shortcut icon" href="'+link.href+'" />');
        
        document.getElementById("icon").innerHTML = "ICON: " + _icon + '<br /><img src="' + _icon +'" />'
    }

    if (_url !== undefined) {
        //var win = window.open(findGetParameter("url"), "_blank", "resizable,scrollbars=yes,status=1");
        document.getElementById("url").innerHTML = "URL: " + _url
    }
}
document.getElementById("message").innerHTML = ""
</script>
    </body>
</html>